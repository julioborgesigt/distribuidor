<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <!-- Meta tag responsiva -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Página do Administrador</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <!-- Biblioteca ProgressBar.js -->
  <script src="https://cdn.jsdelivr.net/npm/progressbar.js"></script>
  <link rel="stylesheet" href="css/style.css">

</head>
<body class="p-3">
  <div class="container">




    
    
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center">
        <button id="darkModeToggle" class="btn toggle-btn" aria-label="Alternar modo escuro">
          <i id="sunIcon" class="bi bi-sun-fill"></i>
          <i id="moonIcon" class="bi bi-moon-fill" style="display: none;"></i>
        </button>
        <h4>Pág. do Adm.</h4>
        <button id="logoutBtn" class="btn logout-btn" title="Logout">
          <i class="bi bi-power"></i>
        </button>
      </div>
    </div>
    
    
  
    


    <!-- Loader de Carregamento -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
      <div class="loader"></div>
    </div>

    <!-- Formulários agrupados em container flex -->
    <div class="form-container">
      <!-- Pré-Cadastro de Usuário -->
      <!-- Disparador (apenas visível em dispositivos móveis) -->
    <div class="d-block d-md-none mb-2">
      <a class="btn btn-secondary w-100 d-flex align-items-center justify-content-between" data-bs-toggle="collapse" href="#preCadastroCollapse" role="button" aria-expanded="false" aria-controls="preCadastroCollapse">
        <span>Pré-Cadastro</span>
        <i class="bi bi-chevron-down"></i>
      </a>
      
    </div>

    <!-- Área do pré-cadastro, envolvida pelo componente collapse -->
    <div class="collapse d-md-block" id="preCadastroCollapse">
      <div class="small-container">
        <h4>Pré-Cadastro</h4>
        <form id="preCadastroForm">
          <div class="mb-2">
            <label for="matricula" class="form-label">Matrícula</label>
            <input type="text" class="form-control" id="matricula" name="matricula" maxlength="8" minlength="8" required>
          </div>
          <div class="mb-2">
            <label for="nome" class="form-label">Nome</label>
            <input type="text" class="form-control" id="nome" name="nome" required>
          </div>
          <div class="mb-2">
            <label for="senha" class="form-label">Senha</label>
            <input type="password" class="form-control" id="senha" name="senha" maxlength="8" minlength="8" required>
          </div>
          <!-- Novo seletor para tipo de cadastro -->
          <div class="mb-2">
            <label for="tipoCadastro" class="form-label">Tipo de Cadastro</label>
            <select class="form-select" id="tipoCadastro" name="tipoCadastro" required>
              <option value="usuario">Usuário Normal</option>
              <option value="admin">Administrador</option>
            </select>
          </div>
          <button type="submit" class="btn btn-success w-100 mt-1">Cadastrar</button>
        </form>
      </div>
    </div>



      <!-- Atualizar Lista e Reset de Senha -->
      <div class="vertical-container">
        <div class="small-container">
          <h4>Atualizar Lista</h4>
          <form id="csvUploadForm" enctype="multipart/form-data">
            <div class="mb-2">
              <label for="csvFile" class="form-label">Planilha CSV</label>
              <input type="file" class="form-control" id="csvFile" name="csvFile" accept=".csv" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Upload</button>
          </form>
        </div>
        <div class="small-container">
          <h4>Reset / Apagar Usuário</h4>
          <form id="userActionForm">
            <div class="mb-2">
              <label for="matriculaAction" class="form-label">Matrícula</label>
              <input type="text" class="form-control" id="matriculaAction" name="matriculaAction" maxlength="8" minlength="8" required>
            </div>
            <div class="d-flex flex-column gap-2">
              <button type="button" id="resetPasswordBtn" class="btn btn-warning">Resetar Senha</button>
              <button type="button" id="deleteUserBtn" class="btn btn-danger">Apagar Usuário</button>
            </div>
          </form>
        </div>
        
        
      </div>
      
      <!-- Container para gráficos -->
      
     

        
          <div class="chart-group">
            

            <div class="chart-header">
              
              <h4>Estatísticas</h4>
            

              <div class="chart-toggle-container">
                <span class="toggle-text">Todos</span>
                <label class="switch">
                  <input type="checkbox" id="chartToggle">
                  <span class="slider"></span>
                </label>
                <span class="toggle-text">Cumprido</span>
              </div>
              



            </div>
            


          

            <div class="chart-row" id="statsRow">
              <!-- Gráficos serão inseridos aqui -->
            </div>

          </div>


      




    </div>

    <!-- Container para filtros e ações -->
    <div class="auto-container">
      <h2>Filtros</h2>
      <div class="row g-2">
        <div class="col-md-2">
          <label for="filtroClasse" class="form-label">Classe</label>
          <select id="filtroClasse" class="form-select">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="filtroAssunto" class="form-label">Assunto</label>
          <select id="filtroAssunto" class="form-select">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="filtroTarjas" class="form-label">Tarjas</label>
          <select id="filtroTarjas" class="form-select">
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="filtroUsuario" class="form-label">Usuário</label>
          <select id="filtroUsuario" class="form-select">
            <option value="">Todos</option>
            <option value="">Nenhum</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="ordenarPrazo" class="form-label">P. P.</label>
          <select id="ordenarPrazo" class="form-select">
            <option value="">Selecione</option>
            <option value="asc">Crescente</option>
            <option value="desc">Decrescente</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="ordenarData" class="form-label">Dt. Int.</label>
          <select id="ordenarData" class="form-select">
            <option value="">Selecione</option>
            <option value="asc">Crescente</option>
            <option value="desc">Decrescente</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="ordenarDias" class="form-label">Dias R.</label>
          <select id="ordenarDias" class="form-select">
            <option value="">Selecione</option>
            <option value="asc">Crescente</option>
            <option value="desc">Decrescente</option>
          </select>
        </div>
        <div class="col-md-2">
          <label for="ordenarIntim" class="form-label">Nº Intim.</label>
          <select id="ordenarIntim" class="form-select">
            <option value="">Selecione</option>
            <option value="asc">Crescente</option>
            <option value="desc">Decrescente</option>
          </select>
        </div>     
        <div class="col-md-2">
          <label for="filtroCumprido" class="form-label">Cumprido?</label>
          <select id="filtroCumprido" class="form-select">
            <option value="nao" selected>Não cumprido</option>
            <option value="sim">Cumprido</option>
            <option value="">Todos</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="buscaProcesso" class="form-label">Busca por Nº P.</label>
          <input type="text" id="buscaProcesso" class="form-control" placeholder="xxxxxxx-xx.xxxx.x.xx.xxxx">
        </div>
        
        

      </div>
      
    </div>


    <div class="auto-container">
      <h2>Ações em massa</h2>
      <div class="row g-2 align-items-center mt-3">
        <div class="col-md-3">
          <input type="text" id="bulkMatricula" class="form-control" placeholder="Mat. dest. (atribuir sel.)" maxlength="8" minlength="8">
        </div>
        <div class="col-md-3">
          <button id="bulkAtribuirBtn" class="btn btn-primary me-2 w-100">Atribuir sel. à Mat.</button>
        </div>
        <div class="col-md-3">
          <button id="bulkExcluirBtn" class="btn btn-danger me-2 w-100">Excluir p. selec.</button>
        </div>
        <div class="col-md-3">
          <button id="bulkCumpridoBtn" class="btn btn-success me-2 w-100">Cumprir p. selec.</button>
        </div>
      </div>

    </div>

    <!-- Container para a tabela -->
    <div class="auto-container">
      <h2>Lista Geral Atualizada</h2>
      <div class="print-buttons mt-3 mb-3">
        <button id="printAllBtn" class="btn btn-primary">Imprimir Tabela Completa</button>
        <button id="printSelectedBtn" class="btn btn-primary">Imprimir Selecionados</button>
      </div>
      <div class="table-responsive">
        <table class="table table-bordered" id="processTable">
          <thead class="table-light">
            <tr>
              <th><input type="checkbox" id="select-all"></th>
              <th>Número do Processo</th>
              <th class="hide-mobile">Prazo P.</th>
              <th class="hide-mobile">Classe Principal</th>
              <!-- Aqui, adicione a classe 'assunto' tanto para o th quanto para os tds -->
              <th class="hide-mobile assunto">Assunto</th>
              <th>Tarjas</th>
              <th class="hide-mobile">Data Int.</th>
              <th>Usuário</th>
              <th>Dias praz.</th>
              <th>Nº Intim.</th>
              <th class="hide-mobile">Cump.</th>
              <th class="hide-mobile">Atribuir Matricula.</th>
            </tr>
          </thead>
          <tbody>
            <!-- As linhas serão inseridas via JavaScript -->
          </tbody>
        </table>
      </div>
    </div>
  </div> <!-- Fim do container principal -->


  <!-- Bootstrap JS (Popper incluso) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>



  <script src="/js/script.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {

      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = '/';
        return;
      }
      
      
    });

    document.getElementById('logoutBtn').addEventListener('click', () => {
        localStorage.removeItem('token');
        window.location.href = '/';
      });

  </script>
</body>
</html>
